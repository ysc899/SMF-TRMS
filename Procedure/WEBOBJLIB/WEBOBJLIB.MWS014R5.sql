DROP PROCEDURE WEBOBJLIB.MWS014R5;

CREATE PROCEDURE WEBOBJLIB.MWS014R5
(
	 IN I_COR 		VARCHAR(3) 	-- COR
	, IN I_UID 		VARCHAR(12) -- 사용자 ID
	, IN I_IP	 	VARCHAR(30)	-- 로그인 IP
	, OUT O_MSGCOD	CHAR(3)	-- 메세지 코드
	, OUT O_ERRCOD	CHAR(10)	 -- 에러 코드
	, IN  I_SDV		VARCHAR(20)	  -- 시스템 구분
	, IN I_DCL		VARCHAR(20)	 -- 문서종류
)
LANGUAGE SQL
DYNAMIC RESULT SETS 1
BEGIN
	-- 메인내용 - 공문/ 공지사항
 DECLARE CUR1 CURSOR WITH RETURN FOR

	SELECT
		 TRIM(A.S014COR)	AS	S014COR	 --회사코드 
		, TRIM(A.S014SEQ)	AS	S014SEQ	 -- 문서순번 
		, TRIM(A.S014WDT)	AS	S014WDT	--작성일자
		, TRIM(A.S014CNM)	AS	S014CNM	-- 작성자
		, TRIM(A.S014DNO)	AS	S014DNO	 --문서번호 
		, TRIM(A.S014DCL)	AS	S014DCL	 -- 문서종류 
		,TRIM(A.S014TIT)	AS	S014TIT		 -- 제목 
		,TRIM(A.S014CON)	AS	S014CON	 -- 내용
		,TRIM(A.S014CUR)	AS	S014CUR
		,TRIM(A.S014DYN)	AS	S014DYN	 -- 삭제여부 
		,TRIM(B.S014FPT)	AS	S014FPT 
		,TRIM(B.S014FNM)	AS	S014FNM 
		,TRIM(B.S014FSNM)	AS	S014FSNM 
	FROM WEBDBLIB.MWS014M@ A
	LEFT JOIN WEBDBLIB . MWS014D@ B 
		ON A.S014COR =B.S014COR AND A.S014SEQ = B.S014SEQ 
	 WHERE A.S014COR = I_COR
	 AND A.S014DYN = 'N'	--삭제여부
	 AND S014DCL = I_DCL
	AND  A.S014SDV IN('ALL','', I_SDV)
	ORDER BY A.S014WDT DESC, A.S014SEQ  DESC  LIMIT 6;


	SET O_MSGCOD = '200';
 OPEN CUR1;
END
