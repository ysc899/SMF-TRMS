--  Generate SQL 
--  Version:                   V7R4M0 190621 
--  Generated on:              22/12/09 13:17:23 
--  Relational Database:       NEODIN 
--  Standards Option:          Db2 for i 
--DROP SPECIFIC PROCEDURE IF EXISTS MCLISOLIB.SEL02_RSTORREPORTPERCENT_MC600M_SP ; 
--SET PATH "QSYS","QSYS2","SYSPROC","SYSIBMADM","NEO018" ; 
CREATE OR REPLACE PROCEDURE MCLISOLIB.SEL02_RSTORREPORTPERCENT_MC600M_SP ( 
  IN $P_COR VARCHAR(3) , 
  IN $P_FDT VARCHAR(8) , 
  IN $P_TDT VARCHAR(8) ) 
  DYNAMIC RESULT SETS 1 
  LANGUAGE SQL 
  SPECIFIC MCLISOLIB.SEL02_RSTORREPORTPERCENT_MC600M_SP 
  NOT DETERMINISTIC 
  MODIFIES SQL DATA 
  CALLED ON NULL INPUT 
  SET OPTION  ALWBLK = *ALLREAD , 
  ALWCPYDTA = *OPTIMIZE , 
  COMMIT = *CHG , 
  DBGVIEW = *SOURCE , 
  DECRESULT = (31, 31, 00) , 
  DFTRDBCOL = *NONE , 
  DLYPRP = *NO , 
  DYNDFTCOL = *NO , 
  DYNUSRPRF = *USER , 
  SRTSEQ = *HEX 
  BEGIN  -- IDR 유승현 미래년도 제거 
DECLARE CUR CURSOR FOR 
SELECT '화학' 
, DECIMAL ( ROUND ( 100. * SCNT2 / SCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * BCNT2 / BCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * DCNT2 / DCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * GCNT2 / GCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * JCNT2 / JCNT , 2 ) , 5 , 2 ) 
FROM ( 
SELECT 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) SCNT ,  --서울건수 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) BCNT ,  --부산건수 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) DCNT ,  --대구건수 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) GCNT ,  --광주건수 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) JCNT ,  --대전건수 
SUM ( CASE WHEN F600CNO = '' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) SCNT2 ,  --서울확인건수 
SUM ( CASE WHEN F600CNO = '6526' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) BCNT2 ,  --부산확인건수 
SUM ( CASE WHEN F600CNO = '6520' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) DCNT2 ,  --대구확인건수 
SUM ( CASE WHEN F600CNO = '6540' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) GCNT2 ,  --광주확인건수 
SUM ( CASE WHEN F600CNO = '6550' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) JCNT2  --대전확인건수 
FROM MCLISDLIB . MC600M@ 
LEFT JOIN MCLISDLIB . MC999D@ AS B 
ON B . F999COR = F600COR AND B . F999CD1 = 'STTT' AND B . F999CD2 = 'EXHS' AND B . F999CD3 = F600HOS 
WHERE F600COR = $P_COR AND F600DAT BETWEEN $P_FDT AND $P_TDT AND F600HAK = '5210' AND F600ACD IN ( '' , '00' ) AND F600C05 <> 'N' AND B . F999CD3 IS NULL 
) 
UNION ALL 
SELECT '면역' 
, DECIMAL ( ROUND ( 100. * SCNT2 / SCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * BCNT2 / BCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * DCNT2 / DCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * GCNT2 / GCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * JCNT2 / JCNT , 2 ) , 5 , 2 ) 
FROM ( 
SELECT 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) SCNT ,  --서울건수 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) BCNT ,  --부산건수 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) DCNT ,  --대구건수 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) GCNT ,  --광주건수 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) JCNT ,  --대전건수 
SUM ( CASE WHEN F600CNO = '' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) SCNT2 ,  --서울확인건수 
SUM ( CASE WHEN F600CNO = '6526' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) BCNT2 ,  --부산확인건수 
SUM ( CASE WHEN F600CNO = '6520' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) DCNT2 ,  --대구확인건수 
SUM ( CASE WHEN F600CNO = '6540' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) GCNT2 ,  --광주확인건수 
SUM ( CASE WHEN F600CNO = '6550' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) JCNT2  -- 대전확인건수 
FROM MCLISDLIB . MC600M@ 
LEFT JOIN MCLISDLIB . MC999D@ AS B 
ON B . F999COR = F600COR AND B . F999CD1 = 'STTT' AND B . F999CD2 = 'EXHS' AND B . F999CD3 = F600HOS 
WHERE F600COR = $P_COR AND F600DAT BETWEEN $P_FDT AND $P_TDT AND F600HAK = '5231' AND F600ACD IN ( '' , '00' ) AND F600C05 <> 'N' AND B . F999CD3 IS NULL 
) 
UNION ALL 
SELECT '혈액' 
, DECIMAL ( ROUND ( 100. * SCNT2 / SCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * BCNT2 / BCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * DCNT2 / DCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * GCNT2 / GCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * JCNT2 / JCNT , 2 ) , 5 , 2 ) 
FROM ( 
SELECT 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) SCNT ,  --서울건수 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) BCNT ,  --부산건수 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) DCNT ,  --대구건수 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) GCNT ,  --광주건수 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) JCNT ,  --대전건수 
SUM ( CASE WHEN F600CNO = '' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) SCNT2 ,  --서울확인건수 
SUM ( CASE WHEN F600CNO = '6526' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) BCNT2 ,  --부산확인건수 
SUM ( CASE WHEN F600CNO = '6520' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) DCNT2 ,  --대구확인건수 
SUM ( CASE WHEN F600CNO = '6540' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) GCNT2 ,  --광주확인건수 
SUM ( CASE WHEN F600CNO = '6550' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) JCNT2  --대전확인건수 
FROM MCLISDLIB . MC600M@ 
LEFT JOIN MCLISDLIB . MC999D@ AS B 
ON B . F999COR = F600COR AND B . F999CD1 = 'STTT' AND B . F999CD2 = 'EXHS' AND B . F999CD3 = F600HOS 
WHERE F600COR = $P_COR AND F600DAT BETWEEN $P_FDT AND $P_TDT AND F600HAK = '5220' AND F600ACD IN ( '' , '00' ) AND F600C05 <> 'N' AND B . F999CD3 IS NULL 
) 
UNION ALL 
SELECT '요경검' 
, DECIMAL ( ROUND ( 100. * SCNT2 / SCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * BCNT2 / BCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * DCNT2 / DCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * GCNT2 / GCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * JCNT2 / JCNT , 2 ) , 5 , 2 ) 
FROM ( 
SELECT 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) SCNT ,  --서울건수 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) BCNT ,  --부산건수 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) DCNT ,  --대구건수 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) GCNT ,  --광주건수 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) JCNT ,  --대전건수 
SUM ( CASE WHEN F600CNO = '' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) SCNT2 ,  --서울확인건수 
SUM ( CASE WHEN F600CNO = '6526' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) BCNT2 ,  --부산확인건수 
SUM ( CASE WHEN F600CNO = '6520' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) DCNT2 ,  --대구확인건수 
SUM ( CASE WHEN F600CNO = '6540' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) GCNT2 ,  --광주확인건수 
SUM ( CASE WHEN F600CNO = '6550' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) JCNT2  --대전확인건수 
FROM MCLISDLIB . MC600M@ 
LEFT JOIN MCLISDLIB . MC999D@ AS B 
ON B . F999COR = F600COR AND B . F999CD1 = 'STTT' AND B . F999CD2 = 'EXHS' AND B . F999CD3 = F600HOS 
WHERE F600COR = $P_COR AND F600DAT BETWEEN $P_FDT AND $P_TDT AND F600HAK = '5212' AND F600ACD IN ( '' , '00' ) AND F600C05 <> 'N' AND B . F999CD3 IS NULL 
) 
UNION ALL 
SELECT '분자미생물' 
, DECIMAL ( ROUND ( 100. * SCNT2 / SCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * BCNT2 / BCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * DCNT2 / DCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * GCNT2 / GCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * JCNT2 / JCNT , 2 ) , 5 , 2 ) 
FROM ( 
SELECT 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) SCNT ,  --서울건수 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) BCNT ,  --부산건수 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) DCNT ,  --대구건수 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) GCNT ,  --광주건수 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) JCNT ,  --대전건수 
SUM ( CASE WHEN F600CNO = '' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) SCNT2 ,  --서울확인건수 
SUM ( CASE WHEN F600CNO = '6526' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) BCNT2 ,  --부산확인건수 
SUM ( CASE WHEN F600CNO = '6520' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) DCNT2 ,  --대구확인건수 
SUM ( CASE WHEN F600CNO = '6540' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) GCNT2 ,  --광주확인건수 
SUM ( CASE WHEN F600CNO = '6550' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) JCNT2  --대전확인건수 
FROM MCLISDLIB . MC600M@ 
LEFT JOIN MCLISDLIB . MC999D@ AS B 
ON B . F999COR = F600COR AND B . F999CD1 = 'STTT' AND B . F999CD2 = 'EXHS' AND B . F999CD3 = F600HOS 
LEFT JOIN MCLISDLIB . MC999D@ AS A 
ON A . F999COR = F600COR AND A . F999CD1 = 'CLIC' AND A . F999CD2 = 'COVI' AND A . F999CD3 = F600GCD 
WHERE F600COR = $P_COR AND F600DAT BETWEEN $P_FDT AND $P_TDT AND F600HAK = '5280' AND F600ACD IN ( '' , '00' ) AND F600C05 <> 'N' AND B . F999CD3 IS NULL 
) 
UNION ALL 
SELECT '코로나' 
, DECIMAL ( ROUND ( 100. * SCNT2 / SCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * BCNT2 / BCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * DCNT2 / DCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * GCNT2 / GCNT , 2 ) , 5 , 2 ) 
, DECIMAL ( ROUND ( 100. * JCNT2 / JCNT , 2 ) , 5 , 2 ) 
FROM ( 
SELECT 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) SCNT ,  --서울건수 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) BCNT ,  --부산건수 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) DCNT ,  --대구건수 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) GCNT ,  --광주건수 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) JCNT ,  --대전건수 
SUM ( CASE WHEN F600CNO = '' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) SCNT2 ,  --서울확인건수 
SUM ( CASE WHEN F600CNO = '6526' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) BCNT2 ,  --부산확인건수 
SUM ( CASE WHEN F600CNO = '6520' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) DCNT2 ,  --대구확인건수 
SUM ( CASE WHEN F600CNO = '6540' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) GCNT2 ,  --광주확인건수 
SUM ( CASE WHEN F600CNO = '6550' AND F600C03 = 'Y' THEN 1 ELSE 0 END ) JCNT2  --대전확인건수 
FROM MCLISDLIB . MC600M@ 
LEFT JOIN MCLISDLIB . MC999D@ AS B 
ON B . F999COR = F600COR AND B . F999CD1 = 'STTT' AND B . F999CD2 = 'EXHS' AND B . F999CD3 = F600HOS 
INNER JOIN MCLISDLIB . MC999D@ AS A 
ON A . F999COR = F600COR AND A . F999CD1 = 'CLIC' AND A . F999CD2 = 'COVI' AND A . F999CD3 = F600GCD 
WHERE F600COR = $P_COR 
AND F600DAT BETWEEN $P_FDT AND $P_TDT 
/* 
( 
	/***** 조건1) 연도가 같은경우 *****/ 
	F600DAT BETWEEN $P_FDT AND ( CASE WHEN $P_TDT > '20221231' 
THEN '20221231' 
ELSE $P_TDT END ) 
	OR 
	/***** 조건2) 연도가 다른경우 + 2021년 포함인 경우 --> 2027년 *****/ 
	F600DAT BETWEEN ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) < '2021' AND '2021' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20270101' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) = '2021' AND '2021' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2027' , SUBSTRING ( $P_FDT , 5 , 4 ) ) 
			ELSE $P_FDT END 
	) AND ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2021' AND '2021' < SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20271231' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2021' AND '2021' = SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2027' , SUBSTRING ( $P_TDT , 5 , 4 ) ) 
			ELSE $P_TDT END 
	) 
	OR 
	/***** 조건3) 연도가 다른경우 + 2021년 포함인 경우 --> 2028년 *****/ 
	F600DAT BETWEEN ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) < '2021' AND '2021' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20280101' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) = '2021' AND '2021' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2028' , SUBSTRING ( $P_FDT , 5 , 4 ) ) 
			ELSE $P_FDT END 
	) AND ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2021' AND '2021' < SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20281231' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2021' AND '2021' = SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2028' , SUBSTRING ( $P_TDT , 5 , 4 ) ) 
			ELSE $P_TDT END 
	) 
	OR 
	/***** 조건4) 연도가 다른경우 + 2021년 포함인 경우 --> 2029년 *****/ 
	F600DAT BETWEEN ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) < '2021' AND '2021' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20290101' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) = '2021' AND '2021' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2029' , SUBSTRING ( $P_FDT , 5 , 4 ) ) 
			ELSE $P_FDT END 
	) AND ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2021' AND '2021' < SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20291231' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2021' AND '2021' = SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2029' , SUBSTRING ( $P_TDT , 5 , 4 ) ) 
			ELSE $P_TDT END 
	) 
	OR 
	/***** 조건5) 연도가 다른경우 + 2021년 포함인 경우 --> 2030년 *****/ 
	F600DAT BETWEEN ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) < '2021' AND '2021' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20300101' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) = '2021' AND '2021' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2030' , SUBSTRING ( $P_FDT , 5 , 4 ) ) 
			ELSE $P_FDT END 
	) AND ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2021' AND '2021' < SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20301231' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2021' AND '2021' = SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2030' , SUBSTRING ( $P_TDT , 5 , 4 ) ) 
			ELSE $P_TDT END 
	) 
	OR 
	/***** 조건6) 연도가 다른경우 + 2022년 포함인 경우 --> 2023년 *****/ 
	F600DAT BETWEEN ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) < '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20230101' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) = '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2023' , SUBSTRING ( $P_FDT , 5 , 4 ) ) 
			ELSE $P_FDT END 
	) AND ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' < SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20231231' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' = SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2023' , SUBSTRING ( $P_TDT , 5 , 4 ) ) 
			ELSE $P_TDT END 
	) 
	OR 
	/***** 조건7) 연도가 다른경우 + 2022년 포함인 경우 --> 2024년 *****/ 
	F600DAT BETWEEN ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) < '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20240101' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) = '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2024' , SUBSTRING ( $P_FDT , 5 , 4 ) ) 
			ELSE $P_FDT END 
	) AND ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' < SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20241231' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' = SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2024' , SUBSTRING ( $P_TDT , 5 , 4 ) ) 
			ELSE $P_TDT END 
	) 
	OR 
	/***** 조건8) 연도가 다른경우 + 2022년 포함인 경우 --> 2025년 *****/ 
	F600DAT BETWEEN ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) < '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20250101' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) = '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2025' , SUBSTRING ( $P_FDT , 5 , 4 ) ) 
			ELSE $P_FDT END 
	) AND ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' < SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20251231' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' = SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2025' , SUBSTRING ( $P_TDT , 5 , 4 ) ) 
			ELSE $P_TDT END 
	) 
	OR 
	/***** 조건9) 연도가 다른경우 + 2022년 포함인 경우 --> 2026년 *****/ 
	F600DAT BETWEEN ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) < '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20260101' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) = '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2026' , SUBSTRING ( $P_FDT , 5 , 4 ) ) 
			ELSE $P_FDT END 
	) AND ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' < SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20261231' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' = SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2026' , SUBSTRING ( $P_TDT , 5 , 4 ) ) 
			ELSE $P_TDT END 
	) 
	OR 
	/***** 조건10) 연도가 다른경우 + 2022년 포함인 경우 --> 2037년 *****/ 
	F600DAT BETWEEN ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) < '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20370101' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) = '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2037' , SUBSTRING ( $P_FDT , 5 , 4 ) ) 
			ELSE $P_FDT END 
	) AND ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' < SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20371231' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' = SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2037' , SUBSTRING ( $P_TDT , 5 , 4 ) ) 
			ELSE $P_TDT END 
	) 
	OR 
	/***** 조건11) 연도가 다른경우 + 2022년 포함인 경우 --> 2038년 *****/ 
	F600DAT BETWEEN ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) < '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20380101' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) = '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2038' , SUBSTRING ( $P_FDT , 5 , 4 ) ) 
			ELSE $P_FDT END 
	) AND ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' < SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20381231' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' = SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2038' , SUBSTRING ( $P_TDT , 5 , 4 ) ) 
			ELSE $P_TDT END 
	) 
	OR 
	/***** 조건12) 연도가 다른경우 + 2022년 포함인 경우 --> 2039년 *****/ 
	F600DAT BETWEEN ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) < '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20390101' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) = '2022' AND '2022' <= SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2039' , SUBSTRING ( $P_FDT , 5 , 4 ) ) 
			ELSE $P_FDT END 
	) AND ( 
		CASE WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' < SUBSTRING ( $P_TDT , 1 , 4 ) THEN '20391231' 
			WHEN SUBSTRING ( $P_FDT , 1 , 4 ) <= '2022' AND '2022' = SUBSTRING ( $P_TDT , 1 , 4 ) THEN CONCAT ( '2039' , SUBSTRING ( $P_TDT , 5 , 4 ) ) 
			ELSE $P_TDT END 
	) 
) 
*/ 
AND F600HAK = '5280' AND F600ACD IN ( '' , '00' ) AND F600C05 <> 'N' AND B . F999CD3 IS NULL 
) 
; 
OPEN CUR ; 
SET RESULT SETS CURSOR CUR ; 
END  ; 
