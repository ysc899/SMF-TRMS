--  Generate SQL 
--  Version:                   V7R4M0 190621 
--  Generated on:              22/12/09 13:15:29 
--  Relational Database:       NEODIN 
--  Standards Option:          Db2 for i 
--DROP SPECIFIC PROCEDURE IF EXISTS MCLISOLIB.SEL02_CORONA19WEEKLYCNT_MC600M_SP ; 
--SET PATH "QSYS","QSYS2","SYSPROC","SYSIBMADM","NEO018" ; 
CREATE OR REPLACE PROCEDURE MCLISOLIB.SEL02_CORONA19WEEKLYCNT_MC600M_SP ( 
  IN $P_COR VARCHAR(3) ) 
  DYNAMIC RESULT SETS 1 
  LANGUAGE SQL 
  SPECIFIC MCLISOLIB.SEL02_CORONA19WEEKLYCNT_MC600M_SP 
  NOT DETERMINISTIC 
  MODIFIES SQL DATA 
  CALLED ON NULL INPUT 
  SET OPTION  ALWBLK = *ALLREAD , 
  ALWCPYDTA = *OPTIMIZE , 
  COMMIT = *NONE , 
  DECRESULT = (31, 31, 00) , 
  DYNDFTCOL = *NO , 
  DYNUSRPRF = *USER , 
  SRTSEQ = *HEX 
  BEGIN  -- IDR 유승현 미래날짜 주석처리 
DECLARE CUR CURSOR FOR 
SELECT ( SELECT CURRENT DATE - 7 DAY FROM SYSIBM . SYSDUMMY1 ) , CNT1 , CNT2 , CNT3 , CNT4 , CNT5 , CNT6 
FROM ( 
SELECT 
SUM ( 1 ) CNT1 , 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) CNT2 , 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) CNT3 , 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) CNT4 , 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) CNT5 , 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) CNT6 
FROM MCLISDLIB . MC600M@ 
WHERE F600COR = $P_COR 
AND F600DAT = REPLACE ( CHAR ( CURRENT DATE - 7 DAY ) , '-' , '' ) 
/* 
( 
	F600DAT = REPLACE ( CHAR ( CURRENT DATE - 7 DAY ) , '-' , '' ) 
	OR F600DAT = '2023' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 7 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2024' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 7 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2025' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 7 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2026' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 7 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2037' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 7 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2038' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 7 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2039' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 7 DAY ) , '-' , '' ) , 5 , 4 ) 
) 
*/ 
AND F600ACD IN ( '' , '00' ) AND F600GCD IN ( '71330' , '71331' , '71332' , '71334' , '71337' , '71338' , '71340' , '71341' , '71346' , '71349' , '71350' , '71351' , '72276' ) 
) 
UNION ALL 
SELECT ( SELECT CURRENT DATE - 6 DAY FROM SYSIBM . SYSDUMMY1 ) , CNT1 , CNT2 , CNT3 , CNT4 , CNT5 , CNT6 
FROM ( 
SELECT 
SUM ( 1 ) CNT1 , 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) CNT2 , 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) CNT3 , 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) CNT4 , 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) CNT5 , 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) CNT6 
FROM MCLISDLIB . MC600M@ 
WHERE F600COR = $P_COR 
AND F600DAT = REPLACE ( CHAR ( CURRENT DATE - 6 DAY ) , '-' , '' ) 
/* 
( 
	F600DAT = REPLACE ( CHAR ( CURRENT DATE - 6 DAY ) , '-' , '' ) 
	OR F600DAT = '2023' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 6 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2024' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 6 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2025' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 6 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2026' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 6 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2037' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 6 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2038' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 6 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2039' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 6 DAY ) , '-' , '' ) , 5 , 4 ) 
) 
*/ 
AND F600ACD IN ( '' , '00' ) AND F600GCD IN ( '71330' , '71331' , '71332' , '71334' , '71337' , '71338' , '71340' , '71341' , '71346' , '71349' , '71350' , '71351' ) 
) 
UNION ALL 
SELECT ( SELECT CURRENT DATE - 5 DAY FROM SYSIBM . SYSDUMMY1 ) , CNT1 , CNT2 , CNT3 , CNT4 , CNT5 , CNT6 
FROM ( 
SELECT 
SUM ( 1 ) CNT1 , 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) CNT2 , 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) CNT3 , 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) CNT4 , 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) CNT5 , 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) CNT6 
FROM MCLISDLIB . MC600M@ 
WHERE F600COR = $P_COR 
AND F600DAT = REPLACE ( CHAR ( CURRENT DATE - 5 DAY ) , '-' , '' ) 
/* 
( 
	F600DAT = REPLACE ( CHAR ( CURRENT DATE - 5 DAY ) , '-' , '' ) 
	OR F600DAT = '2023' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 5 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2024' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 5 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2025' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 5 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2026' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 5 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2037' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 5 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2038' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 5 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2039' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 5 DAY ) , '-' , '' ) , 5 , 4 ) 
) 
*/ 
AND F600ACD IN ( '' , '00' ) AND F600GCD IN ( '71330' , '71331' , '71332' , '71334' , '71337' , '71338' , '71340' , '71341' , '71346' , '71349' , '71350' , '71351' , '72276' ) 
) 
UNION ALL 
SELECT ( SELECT CURRENT DATE - 4 DAY FROM SYSIBM . SYSDUMMY1 ) , CNT1 , CNT2 , CNT3 , CNT4 , CNT5 , CNT6 
FROM ( 
SELECT 
SUM ( 1 ) CNT1 , 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) CNT2 , 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) CNT3 , 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) CNT4 , 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) CNT5 , 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) CNT6 
FROM MCLISDLIB . MC600M@ 
WHERE F600COR = $P_COR 
AND F600DAT = REPLACE ( CHAR ( CURRENT DATE - 4 DAY ) , '-' , '' ) 
/* 
( 
	F600DAT = REPLACE ( CHAR ( CURRENT DATE - 4 DAY ) , '-' , '' ) 
	OR F600DAT = '2023' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 4 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2024' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 4 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2025' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 4 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2026' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 4 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2037' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 4 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2038' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 4 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2039' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 4 DAY ) , '-' , '' ) , 5 , 4 ) 
) 
*/ 
AND F600ACD IN ( '' , '00' ) AND F600GCD IN ( '71330' , '71331' , '71332' , '71334' , '71337' , '71338' , '71340' , '71341' , '71346' , '71349' , '71350' , '71351' , '72276' ) 
) 
UNION ALL 
SELECT ( SELECT CURRENT DATE - 3 DAY FROM SYSIBM . SYSDUMMY1 ) , CNT1 , CNT2 , CNT3 , CNT4 , CNT5 , CNT6 
FROM ( 
SELECT 
SUM ( 1 ) CNT1 , 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) CNT2 , 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) CNT3 , 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) CNT4 , 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) CNT5 , 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) CNT6 
FROM MCLISDLIB . MC600M@ 
WHERE F600COR = $P_COR 
AND F600DAT = REPLACE ( CHAR ( CURRENT DATE - 3 DAY ) , '-' , '' ) 
/* 
( 
	F600DAT = REPLACE ( CHAR ( CURRENT DATE - 3 DAY ) , '-' , '' ) 
	OR F600DAT = '2023' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 3 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2024' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 3 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2025' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 3 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2026' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 3 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2037' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 3 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2038' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 3 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2039' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 3 DAY ) , '-' , '' ) , 5 , 4 ) 
) 
*/ 
AND F600ACD IN ( '' , '00' ) AND F600GCD IN ( '71330' , '71331' , '71332' , '71334' , '71337' , '71338' , '71340' , '71341' , '72276' ) 
) 
UNION ALL 
SELECT ( SELECT CURRENT DATE - 2 DAY FROM SYSIBM . SYSDUMMY1 ) , CNT1 , CNT2 , CNT3 , CNT4 , CNT5 , CNT6 
FROM ( 
SELECT 
SUM ( 1 ) CNT1 , 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) CNT2 , 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) CNT3 , 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) CNT4 , 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) CNT5 , 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) CNT6 
FROM MCLISDLIB . MC600M@ 
WHERE F600COR = $P_COR 
AND F600DAT = REPLACE ( CHAR ( CURRENT DATE - 2 DAY ) , '-' , '' ) 
/* 
( 
	F600DAT = REPLACE ( CHAR ( CURRENT DATE - 2 DAY ) , '-' , '' ) 
	OR F600DAT = '2023' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 2 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2024' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 2 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2025' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 2 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2026' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 2 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2037' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 2 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2038' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 2 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2039' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 2 DAY ) , '-' , '' ) , 5 , 4 ) 
) 
*/ 
AND F600ACD IN ( '' , '00' ) AND F600GCD IN ( '71330' , '71331' , '71332' , '71334' , '71337' , '71338' , '71340' , '71341' , '71346' , '71349' , '71350' , '71351' , '72276' ) 
) 
UNION ALL 
SELECT ( SELECT CURRENT DATE - 1 DAY FROM SYSIBM . SYSDUMMY1 ) , CNT1 , CNT2 , CNT3 , CNT4 , CNT5 , CNT6 
FROM ( 
SELECT 
SUM ( 1 ) CNT1 , 
SUM ( CASE WHEN F600CNO = '' THEN 1 ELSE 0 END ) CNT2 , 
SUM ( CASE WHEN F600CNO = '6526' THEN 1 ELSE 0 END ) CNT3 , 
SUM ( CASE WHEN F600CNO = '6520' THEN 1 ELSE 0 END ) CNT4 , 
SUM ( CASE WHEN F600CNO = '6540' THEN 1 ELSE 0 END ) CNT5 , 
SUM ( CASE WHEN F600CNO = '6550' THEN 1 ELSE 0 END ) CNT6 
FROM MCLISDLIB . MC600M@ 
WHERE F600COR = $P_COR 
AND F600DAT = REPLACE ( CHAR ( CURRENT DATE - 1 DAY ) , '-' , '' ) 
/* 
( 
	F600DAT = REPLACE ( CHAR ( CURRENT DATE - 1 DAY ) , '-' , '' ) 
	OR F600DAT = '2023' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 1 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2024' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 1 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2025' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 1 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2026' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 1 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2037' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 1 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2038' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 1 DAY ) , '-' , '' ) , 5 , 4 ) 
	OR F600DAT = '2039' || SUBSTRING ( REPLACE ( CHAR ( CURRENT DATE - 1 DAY ) , '-' , '' ) , 5 , 4 ) 
) 
*/ 
AND F600ACD IN ( '' , '00' ) AND F600GCD IN ( '71330' , '71331' , '71332' , '71334' , '71337' , '71338' , '71340' , '71341' , '71346' , '71349' , '71350' , '71351' , '72276' ) 
) ; 
OPEN CUR ; 
SET RESULT SETS CURSOR CUR ; 
END  ; 
