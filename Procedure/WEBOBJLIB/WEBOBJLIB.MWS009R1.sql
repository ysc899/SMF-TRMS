--DROP PROCEDURE WEBOBJLIB.MWS009R1;

CREATE OR REPLACE PROCEDURE WEBOBJLIB.MWS009R1
(
     	IN  I_COR VARCHAR(3)
	  , IN  I_UID VARCHAR(12)
	  , IN  I_IP  VARCHAR(30)
	  , OUT O_MSGCOD VARCHAR(3)
	  , OUT O_ERRCOD VARCHAR(10)
   	  , IN  I_F120PCD       VARCHAR(5)
   	  , IN  I_F120FNM       VARCHAR(40)
)
LANGUAGE SQL
DYNAMIC RESULT SETS 1
BEGIN
	--엑셀접수포멧 리스트 조회
	DECLARE C1 CURSOR WITH RETURN FOR
SELECT A . F120PCD
	, A . F120FNM
	, A . F120MBC
	, B . F910NAM
FROM MCLISDLIB . MC120M@ A LEFT OUTER JOIN JMTSLIB . MM910M@ B ON A . F120MBC = B . F910SAB AND A . F120COR = B . F910COR
--WHERE F120MBC != ''
--AND F120PCD LIKE I_F120PCD || '%'
WHERE F120PCD LIKE I_F120PCD || '%'
AND F120FNM LIKE '%' || I_F120FNM || '%' 
ORDER BY 2,1;
SET O_ERRCOD = '';
SET O_MSGCOD = 200 ;
	OPEN C1 ;
END